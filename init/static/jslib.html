<script language="JavaScript" type="text/javascript">
function toggle_vis(name){
	_toggle_vis(name,'table-row')
}

function toggle_vis_block(name){
	_toggle_vis(name,'block')
}

function _toggle_vis(name, mode){
        cells = document.getElementsByName(name);
        for(j = 0; j < cells.length; j++) {
                if (cells[j].style.display == 'none' || cells[j].style.display == "") {
                        cells[j].style.display = mode;
                } else {
                        cells[j].style.display = 'none';
                }
        }
}

function checkEnter(e) {
  submit_form_on_enter(e, document.svcform)
}

function submit_form_on_enter(e, form) {
  var characterCode
  if(e && e.which) {
    e = e
    characterCode = e.which
  }else{
//    e = event
    characterCode = e.keyCode
  }
  if(characterCode == 13) {
    form.submit()
    return false
  }else{
    return true
  }
}

function is_enter(e) {
  var characterCode
  if(e && e.which) {
    e = e
    characterCode = e.which
  }else{
    characterCode = e.keyCode
  }
  if(characterCode == 13) {
    return true
  }else{
    return false
  }
}

function select_all(checked, aform) {
  var elem = aform.elements;
  for(var i = 0; i < elem.length; i++) {
    if (elem[i].type == 'checkbox' && elem[i].disabled == false && elem[i].name.match(/^check_/)) {
      elem[i].checked = checked
    }
  }
}

function dumpProps(obj, parent) {
   // Go through all the properties of the passed-in object
   for (var i in obj) {
      // if a parent (2nd parameter) was passed in, then use that to
      // build the message. Message includes i (the object's property name)
      // then the object's property value on a new line
      if (parent) { var msg = parent + "." + i + "\n" + obj[i]; } else { var msg = i + "\n" + obj[i]; }
      // Display the message. If the user clicks "OK", then continue. If they
      // click "CANCEL" then quit this level of recursion
      if (!confirm(msg)) { return; }
      // If this property (i) is an object, then recursively process the object
      if (typeof obj[i] == "object") {
         if (parent) { dumpProps(obj[i], parent + "." + i); } else { dumpProps(obj[i], i); }
      }
   }
}

function show_eid(id) {
  if ((navigator.appName == 'Netscape')||(navigator.appName == 'Opera')) {
    document.getElementById(id).style['display']='table-row'
  } else {
    document.getElementById(id).style['display']='block'
  }
}

function hide_eid(id) {
  document.getElementById(id).style['display']='none'
}

function toggle_filter_value_input() {
  id = document.getElementById('addfilter').value
  id = 'addfilter_opt'+id
  if (document.getElementById(id).title == '') {
    hide_eid('tr_filtervalue')
  } else {
    show_eid('tr_filtervalue')
    document.getElementById('filtervalue').focus()
  }
}

//
// table class js functions
//
var timer;
var showMode = 'table-cell';
if (document.all) showMode='block';
function check_toggle_vis(checked, col){
    cells = document.getElementsByName(col);
    mode = checked ? showMode : 'none';
    for(j = 0; j < cells.length; j++) {
        cells[j].style.display = mode;
    }
}
function click_toggle_vis(name, mode){
    cells = document.getElementsByName(name);
    for(j = 0; j < cells.length; j++) {
        if (cells[j].style.display == 'none' || cells[j].style.display == "") {
            cells[j].style.display = mode;
        } else {
            cells[j].style.display = 'none';
        }
    }
}
function check_all(name, checked){
    c = document.getElementsByName(name);
    for(i = 0; i < c.length; i++) {
        if (c[i].type == 'checkbox' && c[i].disabled == false) {
            c[i].checked = checked
            c[i].value = checked
        }
    }
}
function getIdsByName(names){
    ids = []
    for (j = 0; j < names.length; j++) {
        c = document.getElementsByName(names[j]);
        for (i = 0; i < c.length; i++) {
            ids.push(c[i].id)
        }
    }
    return ids
}
function eval_js_in_ajax_response(id) {
    l = document.getElementsByName(id+"_to_eval")
    for (i = 0; i < l.length; i++) {
        eval(l[i].innerHTML)
    }
}
function sparkl(url, id) {
    chartoptions = {type: 'tristate'};
    $.getJSON(url, function(data) {
        $(document.getElementById(id)).sparkline(data, chartoptions);
    });
}
function comp_status_plot(url, id) {
    $.jqplot.config.enablePlugins = true;
    $.getJSON(url, function(data) {
	$.jqplot(id, data[1], {
	    stackSeries: true,
	    legend: {
                show: false,
                location: 'nw'
            },
	    grid: {
                borderWidth: 0.5,
                shadowOffset: 1.0,
                shadowWidth: 2
            },
	    seriesDefaults: {
                fill: true,
                shadowAngle: 135,
                shadowOffset: 1.0,
                shadowWidth: 2
            },
	    series: [
                {
                    label: 'ok',
                    color: 'lightgreen'
                },
                {
                    label: 'errors',
                    color: 'red'
                },
                {
                    label: 'n/a',
                    color: 'gray'
                }
            ],
	    axes: {
		xaxis: {
		    renderer: $.jqplot.CategoryAxisRenderer, 
		    tickOptions: {formatString:'%s'},
                    ticks: data[0],
		}, 
		yaxis: {
		    min: 0, 
		    tickOptions:{
                        showLabel: false,
                        size: 0,
                        formatString:'%d'
                    }
		}
	    }
	});
    });
}
function table_ajax_submit(url, id, inputs, additional_inputs, input_name, spinner) {
    s = inputs.concat(additional_inputs).concat(getIdsByName(input_name))
    var query=""
    for (i=0; i<s.length; i++) {
        if (i > 0) {query=query+"&"}
        query=query+encodeURIComponent(s[i])+"="+encodeURIComponent(document.getElementById(s[i]).value);
    }
    $.ajax({
         type: "POST",
         url: url,
         data: query,
         beforeSend: function(req){
	     document.getElementById(id).innerHTML=spinner
         },
         success: function(msg){
             document.getElementById(id).innerHTML=msg
             eval_js_in_ajax_response(id)
         }
    })
}
function toggle_extra(url, id) {
    e = document.getElementById(id)
    if (e.style['display']=='none') {
        e.style['display']='table-cell'
        ajax(url, [], id)
    } else {
        e.style['display']='none'
    }
}
function timepicker(e) {
    Calendar.setup({
        inputField:e.id,
        ifFormat:"%Y-%m-%d %H:%M:%S",
        showsTime: true,timeFormat: "24"
    })
}
function checked_nodes() {
    l = document.getElementsByName('nodes_ck');
    d = new Array()
    for(i=0; i<l.length; i++) {
        if (l[i].type == 'checkbox' && l[i].disabled == false && l[i].checked) {
            d.push(l[i].id.replace("nodes_ckid_",""));
        }
    }
    return d.join(",");
}

</script>
